{"version":3,"file":"y-tiptap.js","sources":["../src/plugins/keys.js","../src/utils.js","../src/plugins/sync-plugin.js","../src/lib.js","../src/plugins/cursor-plugin.js","../src/plugins/undo-plugin.js"],"sourcesContent":["import { PluginKey } from 'prosemirror-state' // eslint-disable-line\r\n\r\n/**\r\n * The unique prosemirror plugin key for syncPlugin\r\n *\r\n * @public\r\n */\r\nexport const ySyncPluginKey = new PluginKey('y-sync')\r\n\r\n/**\r\n * The unique prosemirror plugin key for undoPlugin\r\n *\r\n * @public\r\n */\r\nexport const yUndoPluginKey = new PluginKey('y-undo')\r\n\r\n/**\r\n * The unique prosemirror plugin key for cursorPlugin\r\n *\r\n * @public\r\n */\r\nexport const yCursorPluginKey = new PluginKey('yjs-cursor')\r\n","import * as sha256 from 'lib0/hash/sha256'\r\nimport * as buf from 'lib0/buffer'\r\n\r\n/**\r\n * Custom function to transform sha256 hash to N byte\r\n *\r\n * @param {Uint8Array} digest\r\n */\r\nconst _convolute = digest => {\r\n  const N = 6\r\n  for (let i = N; i < digest.length; i++) {\r\n    digest[i % N] = digest[i % N] ^ digest[i]\r\n  }\r\n  return digest.slice(0, N)\r\n}\r\n\r\n/**\r\n * @param {any} json\r\n */\r\nexport const hashOfJSON = (json) => buf.toBase64(_convolute(sha256.digest(buf.encodeAny(json))))\r\n","/**\r\n * @module bindings/prosemirror\r\n */\r\n\r\nimport { createMutex } from 'lib0/mutex'\r\nimport * as PModel from 'prosemirror-model'\r\nimport { AllSelection, Plugin, TextSelection, NodeSelection, Selection } from \"prosemirror-state\"; // eslint-disable-line\r\nimport * as math from 'lib0/math'\r\nimport * as object from 'lib0/object'\r\nimport * as set from 'lib0/set'\r\nimport { simpleDiff } from 'lib0/diff'\r\nimport * as error from 'lib0/error'\r\nimport { ySyncPluginKey, yUndoPluginKey } from './keys.js'\r\nimport * as Y from 'yjs'\r\nimport {\r\n  absolutePositionToRelativePosition,\r\n  relativePositionToAbsolutePosition\r\n} from '../lib.js'\r\nimport * as random from 'lib0/random'\r\nimport * as environment from 'lib0/environment'\r\nimport * as dom from 'lib0/dom'\r\nimport * as eventloop from 'lib0/eventloop'\r\nimport * as map from 'lib0/map'\r\nimport * as utils from '../utils.js'\r\n\r\n/**\r\n * @typedef {Object} BindingMetadata\r\n * @property {ProsemirrorMapping} BindingMetadata.mapping\r\n * @property {Map<import('prosemirror-model').MarkType, boolean>} BindingMetadata.isOMark - is overlapping mark\r\n */\r\n\r\n/**\r\n * @return BindingMetadata\r\n */\r\nexport const createEmptyMeta = () => ({\r\n  mapping: new Map(),\r\n  isOMark: new Map()\r\n})\r\n\r\n/**\r\n * @param {Y.Item} item\r\n * @param {Y.Snapshot} [snapshot]\r\n */\r\nexport const isVisible = (item, snapshot) =>\r\n  snapshot === undefined\r\n    ? !item.deleted\r\n    : (snapshot.sv.has(item.id.client) && /** @type {number} */\r\n      (snapshot.sv.get(item.id.client)) > item.id.clock &&\r\n      !Y.isDeleted(snapshot.ds, item.id))\r\n\r\n/**\r\n * Either a node if type is YXmlElement or an Array of text nodes if YXmlText\r\n * @typedef {Map<Y.AbstractType<any>, PModel.Node | Array<PModel.Node>>} ProsemirrorMapping\r\n */\r\n\r\n/**\r\n * @typedef {Object} ColorDef\r\n * @property {string} ColorDef.light\r\n * @property {string} ColorDef.dark\r\n */\r\n\r\n/**\r\n * @typedef {Object} YSyncOpts\r\n * @property {Array<ColorDef>} [YSyncOpts.colors]\r\n * @property {Map<string,ColorDef>} [YSyncOpts.colorMapping]\r\n * @property {Y.PermanentUserData|null} [YSyncOpts.permanentUserData]\r\n * @property {ProsemirrorMapping} [YSyncOpts.mapping]\r\n * @property {function} [YSyncOpts.onFirstRender] Fired when the content from Yjs is initially rendered to ProseMirror\r\n */\r\n\r\n/**\r\n * @type {Array<ColorDef>}\r\n */\r\nconst defaultColors = [{ light: '#ecd44433', dark: '#ecd444' }]\r\n\r\n/**\r\n * @param {Map<string,ColorDef>} colorMapping\r\n * @param {Array<ColorDef>} colors\r\n * @param {string} user\r\n * @return {ColorDef}\r\n */\r\nconst getUserColor = (colorMapping, colors, user) => {\r\n  // @todo do not hit the same color twice if possible\r\n  if (!colorMapping.has(user)) {\r\n    if (colorMapping.size < colors.length) {\r\n      const usedColors = set.create()\r\n      colorMapping.forEach((color) => usedColors.add(color))\r\n      colors = colors.filter((color) => !usedColors.has(color))\r\n    }\r\n    colorMapping.set(user, random.oneOf(colors))\r\n  }\r\n  return /** @type {ColorDef} */ (colorMapping.get(user))\r\n}\r\n\r\n/**\r\n * This plugin listens to changes in prosemirror view and keeps yXmlState and view in sync.\r\n *\r\n * This plugin also keeps references to the type and the shared document so other plugins can access it.\r\n * @param {Y.XmlFragment} yXmlFragment\r\n * @param {YSyncOpts} opts\r\n * @return {any} Returns a prosemirror plugin that binds to this type\r\n */\r\nexport const ySyncPlugin = (yXmlFragment, {\r\n  colors = defaultColors,\r\n  colorMapping = new Map(),\r\n  permanentUserData = null,\r\n  onFirstRender = () => {},\r\n  mapping\r\n} = {}) => {\r\n  let initialContentChanged = false\r\n  const binding = new ProsemirrorBinding(yXmlFragment, mapping)\r\n  const plugin = new Plugin({\r\n    props: {\r\n      editable: (state) => {\r\n        const syncState = ySyncPluginKey.getState(state)\r\n        return syncState.snapshot == null && syncState.prevSnapshot == null\r\n      }\r\n    },\r\n    key: ySyncPluginKey,\r\n    state: {\r\n      /**\r\n       * @returns {any}\r\n       */\r\n      init: (_initargs, _state) => {\r\n        return {\r\n          type: yXmlFragment,\r\n          doc: yXmlFragment.doc,\r\n          binding,\r\n          snapshot: null,\r\n          prevSnapshot: null,\r\n          isChangeOrigin: false,\r\n          isUndoRedoOperation: false,\r\n          addToHistory: true,\r\n          colors,\r\n          colorMapping,\r\n          permanentUserData\r\n        }\r\n      },\r\n      apply: (tr, pluginState) => {\r\n        const change = tr.getMeta(ySyncPluginKey)\r\n        if (change !== undefined) {\r\n          pluginState = Object.assign({}, pluginState)\r\n          for (const key in change) {\r\n            pluginState[key] = change[key]\r\n          }\r\n        }\r\n        pluginState.addToHistory = tr.getMeta('addToHistory') !== false\r\n        // always set isChangeOrigin. If undefined, this is not change origin.\r\n        pluginState.isChangeOrigin = change !== undefined &&\r\n          !!change.isChangeOrigin\r\n        pluginState.isUndoRedoOperation = change !== undefined && !!change.isChangeOrigin && !!change.isUndoRedoOperation\r\n        if (binding.prosemirrorView !== null) {\r\n          if (\r\n            change !== undefined &&\r\n            (change.snapshot != null || change.prevSnapshot != null)\r\n          ) {\r\n            // snapshot changed, rerender next\r\n            eventloop.timeout(0, () => {\r\n              if (binding.prosemirrorView == null) {\r\n                return\r\n              }\r\n              if (change.restore == null) {\r\n                binding._renderSnapshot(\r\n                  change.snapshot,\r\n                  change.prevSnapshot,\r\n                  pluginState\r\n                )\r\n              } else {\r\n                binding._renderSnapshot(\r\n                  change.snapshot,\r\n                  change.snapshot,\r\n                  pluginState\r\n                )\r\n                // reset to current prosemirror state\r\n                delete pluginState.restore\r\n                delete pluginState.snapshot\r\n                delete pluginState.prevSnapshot\r\n                binding.mux(() => {\r\n                  binding._prosemirrorChanged(\r\n                    binding.prosemirrorView.state.doc\r\n                  )\r\n                })\r\n              }\r\n            })\r\n          }\r\n        }\r\n        return pluginState\r\n      }\r\n    },\r\n    view: (view) => {\r\n      binding.initView(view)\r\n      if (mapping == null) {\r\n        // force rerender to update the bindings mapping\r\n        binding._forceRerender()\r\n      }\r\n      onFirstRender()\r\n      return {\r\n        update: () => {\r\n          const pluginState = plugin.getState(view.state)\r\n          if (\r\n            pluginState.snapshot == null && pluginState.prevSnapshot == null\r\n          ) {\r\n            if (\r\n              // If the content doesn't change initially, we don't render anything to Yjs\r\n              // If the content was cleared by a user action, we want to catch the change and\r\n              // represent it in Yjs\r\n              initialContentChanged ||\r\n              view.state.doc.content.findDiffStart(\r\n                view.state.doc.type.createAndFill().content\r\n              ) !== null\r\n            ) {\r\n              initialContentChanged = true\r\n              if (\r\n                pluginState.addToHistory === false &&\r\n                !pluginState.isChangeOrigin\r\n              ) {\r\n                const yUndoPluginState = yUndoPluginKey.getState(view.state)\r\n                /**\r\n                 * @type {Y.UndoManager}\r\n                 */\r\n                const um = yUndoPluginState && yUndoPluginState.undoManager\r\n                if (um) {\r\n                  um.stopCapturing()\r\n                }\r\n              }\r\n              binding.mux(() => {\r\n                /** @type {Y.Doc} */ (pluginState.doc).transact((tr) => {\r\n                  tr.meta.set('addToHistory', pluginState.addToHistory)\r\n                  binding._prosemirrorChanged(view.state.doc)\r\n                }, ySyncPluginKey)\r\n              })\r\n            }\r\n          }\r\n        },\r\n        destroy: () => {\r\n          binding.destroy()\r\n        }\r\n      }\r\n    }\r\n  })\r\n  return plugin\r\n}\r\n\r\n/**\r\n * @param {import('prosemirror-state').Transaction} tr\r\n * @param {ReturnType<typeof getRelativeSelection>} relSel\r\n * @param {ProsemirrorBinding} binding\r\n */\r\nconst restoreRelativeSelection = (tr, relSel, binding) => {\r\n  if (relSel !== null && relSel.anchor !== null && relSel.head !== null) {\r\n    if (relSel.type === 'all') {\r\n      tr.setSelection(new AllSelection(tr.doc))\r\n    } else if (relSel.type === 'node') {\r\n      const anchor = relativePositionToAbsolutePosition(\r\n        binding.doc,\r\n        binding.type,\r\n        relSel.anchor,\r\n        binding.mapping\r\n      )\r\n      tr.setSelection(NodeSelection.create(tr.doc, anchor))\r\n    } else if (relSel.type === 'text') {\r\n      const anchor = relativePositionToAbsolutePosition(\r\n        binding.doc,\r\n        binding.type,\r\n        relSel.anchor,\r\n        binding.mapping\r\n      )\r\n      const head = relativePositionToAbsolutePosition(\r\n        binding.doc,\r\n        binding.type,\r\n        relSel.head,\r\n        binding.mapping\r\n      )\r\n      if (anchor !== null && head !== null) {\r\n        tr.setSelection(TextSelection.between(tr.doc.resolve(anchor), tr.doc.resolve(head)))\r\n      }\r\n    } else {\r\n      const anchor = relativePositionToAbsolutePosition(\r\n        binding.doc,\r\n        binding.type,\r\n        relSel.anchor,\r\n        binding.mapping\r\n      )\r\n      const head = relativePositionToAbsolutePosition(\r\n        binding.doc,\r\n        binding.type,\r\n        relSel.head,\r\n        binding.mapping\r\n      )\r\n      if (anchor !== null && head !== null) {\r\n        tr.setSelection(Selection.fromJSON(tr.doc, {\r\n          type: relSel.type,\r\n          anchor,\r\n          head\r\n        }))\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * @param {ProsemirrorBinding} pmbinding\r\n * @param {import('prosemirror-state').EditorState} state\r\n */\r\nexport const getRelativeSelection = (pmbinding, state) => ({\r\n  type: /** @type {any} */ (state.selection).jsonID,\r\n  anchor: absolutePositionToRelativePosition(\r\n    state.selection.anchor,\r\n    pmbinding.type,\r\n    pmbinding.mapping\r\n  ),\r\n  head: absolutePositionToRelativePosition(\r\n    state.selection.head,\r\n    pmbinding.type,\r\n    pmbinding.mapping\r\n  )\r\n})\r\n\r\n/**\r\n * Binding for prosemirror.\r\n *\r\n * @protected\r\n */\r\nexport class ProsemirrorBinding {\r\n  /**\r\n   * @param {Y.XmlFragment} yXmlFragment The bind source\r\n   * @param {ProsemirrorMapping} mapping\r\n   */\r\n  constructor (yXmlFragment, mapping = new Map()) {\r\n    this.type = yXmlFragment\r\n    /**\r\n     * this will be set once the view is created\r\n     * @type {any}\r\n     */\r\n    this.prosemirrorView = null\r\n    this.mux = createMutex()\r\n    this.mapping = mapping\r\n    /**\r\n     * Is overlapping mark - i.e. mark does not exclude itself.\r\n     *\r\n     * @type {Map<import('prosemirror-model').MarkType, boolean>}\r\n     */\r\n    this.isOMark = new Map()\r\n    this._observeFunction = this._typeChanged.bind(this)\r\n    /**\r\n     * @type {Y.Doc}\r\n     */\r\n    // @ts-ignore\r\n    this.doc = yXmlFragment.doc\r\n    /**\r\n     * current selection as relative positions in the Yjs model\r\n     */\r\n    this.beforeTransactionSelection = null\r\n    this.beforeAllTransactions = () => {\r\n      if (this.beforeTransactionSelection === null && this.prosemirrorView != null) {\r\n        this.beforeTransactionSelection = getRelativeSelection(\r\n          this,\r\n          this.prosemirrorView.state\r\n        )\r\n      }\r\n    }\r\n    this.afterAllTransactions = () => {\r\n      this.beforeTransactionSelection = null\r\n    }\r\n    this._domSelectionInView = null\r\n  }\r\n\r\n  /**\r\n   * Create a transaction for changing the prosemirror state.\r\n   *\r\n   * @returns\r\n   */\r\n  get _tr () {\r\n    return this.prosemirrorView.state.tr.setMeta('addToHistory', false)\r\n  }\r\n\r\n  _isLocalCursorInView () {\r\n    if (!this.prosemirrorView.hasFocus()) return false\r\n    if (environment.isBrowser && this._domSelectionInView === null) {\r\n      // Calculate the domSelectionInView and clear by next tick after all events are finished\r\n      eventloop.timeout(0, () => {\r\n        this._domSelectionInView = null\r\n      })\r\n      this._domSelectionInView = this._isDomSelectionInView()\r\n    }\r\n    return this._domSelectionInView\r\n  }\r\n\r\n  _isDomSelectionInView () {\r\n    const selection = this.prosemirrorView._root.getSelection()\r\n\r\n    if (selection == null || selection.anchorNode == null) return false\r\n\r\n    const range = this.prosemirrorView._root.createRange()\r\n    range.setStart(selection.anchorNode, selection.anchorOffset)\r\n    range.setEnd(selection.focusNode, selection.focusOffset)\r\n\r\n    // This is a workaround for an edgecase where getBoundingClientRect will\r\n    // return zero values if the selection is collapsed at the start of a newline\r\n    // see reference here: https://stackoverflow.com/a/59780954\r\n    const rects = range.getClientRects()\r\n    if (rects.length === 0) {\r\n      // probably buggy newline behavior, explicitly select the node contents\r\n      if (range.startContainer && range.collapsed) {\r\n        range.selectNodeContents(range.startContainer)\r\n      }\r\n    }\r\n\r\n    const bounding = range.getBoundingClientRect()\r\n    const documentElement = dom.doc.documentElement\r\n\r\n    return bounding.bottom >= 0 && bounding.right >= 0 &&\r\n      bounding.left <=\r\n        (window.innerWidth || documentElement.clientWidth || 0) &&\r\n      bounding.top <= (window.innerHeight || documentElement.clientHeight || 0)\r\n  }\r\n\r\n  /**\r\n   * @param {Y.Snapshot} snapshot\r\n   * @param {Y.Snapshot} prevSnapshot\r\n   */\r\n  renderSnapshot (snapshot, prevSnapshot) {\r\n    if (!prevSnapshot) {\r\n      prevSnapshot = Y.createSnapshot(Y.createDeleteSet(), new Map())\r\n    }\r\n    this.prosemirrorView.dispatch(\r\n      this._tr.setMeta(ySyncPluginKey, { snapshot, prevSnapshot })\r\n    )\r\n  }\r\n\r\n  unrenderSnapshot () {\r\n    this.mapping.clear()\r\n    this.mux(() => {\r\n      const fragmentContent = this.type.toArray().map((t) =>\r\n        createNodeFromYElement(\r\n          /** @type {Y.XmlElement} */ (t),\r\n          this.prosemirrorView.state.schema,\r\n          this\r\n        )\r\n      ).filter((n) => n !== null)\r\n      // @ts-ignore\r\n      const tr = this._tr.replace(\r\n        0,\r\n        this.prosemirrorView.state.doc.content.size,\r\n        new PModel.Slice(PModel.Fragment.from(fragmentContent), 0, 0)\r\n      )\r\n      tr.setMeta(ySyncPluginKey, { snapshot: null, prevSnapshot: null })\r\n      this.prosemirrorView.dispatch(tr)\r\n    })\r\n  }\r\n\r\n  _forceRerender () {\r\n    this.mapping.clear()\r\n    this.mux(() => {\r\n      // If this is a forced rerender, this might neither happen as a pm change nor within a Yjs\r\n      // transaction. Then the \"before selection\" doesn't exist. In this case, we need to create a\r\n      // relative position before replacing content. Fixes #126\r\n      const sel = this.beforeTransactionSelection !== null ? null : this.prosemirrorView.state.selection\r\n      const fragmentContent = this.type.toArray().map((t) =>\r\n        createNodeFromYElement(\r\n          /** @type {Y.XmlElement} */ (t),\r\n          this.prosemirrorView.state.schema,\r\n          this\r\n        )\r\n      ).filter((n) => n !== null)\r\n      // @ts-ignore\r\n      const tr = this._tr.replace(\r\n        0,\r\n        this.prosemirrorView.state.doc.content.size,\r\n        new PModel.Slice(PModel.Fragment.from(fragmentContent), 0, 0)\r\n      )\r\n      if (sel) {\r\n        /**\r\n         * If the Prosemirror document we just created from this.type is\r\n         * smaller than the previous document, the selection might be\r\n         * out of bound, which would make Prosemirror throw an error.\r\n         */\r\n        const clampedAnchor = math.min(math.max(sel.anchor, 0), tr.doc.content.size)\r\n        const clampedHead = math.min(math.max(sel.head, 0), tr.doc.content.size)\r\n\r\n        tr.setSelection(TextSelection.create(tr.doc, clampedAnchor, clampedHead))\r\n      }\r\n      this.prosemirrorView.dispatch(\r\n        tr.setMeta(ySyncPluginKey, { isChangeOrigin: true, binding: this })\r\n      )\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @param {Y.Snapshot|Uint8Array} snapshot\r\n   * @param {Y.Snapshot|Uint8Array} prevSnapshot\r\n   * @param {Object} pluginState\r\n   */\r\n  _renderSnapshot (snapshot, prevSnapshot, pluginState) {\r\n    /**\r\n     * The document that contains the full history of this document.\r\n     * @type {Y.Doc}\r\n     */\r\n    let historyDoc = this.doc\r\n    let historyType = this.type\r\n    if (!snapshot) {\r\n      snapshot = Y.snapshot(this.doc)\r\n    }\r\n    if (snapshot instanceof Uint8Array || prevSnapshot instanceof Uint8Array) {\r\n      if (!(snapshot instanceof Uint8Array) || !(prevSnapshot instanceof Uint8Array)) {\r\n        // expected both snapshots to be v2 updates\r\n        error.unexpectedCase()\r\n      }\r\n      historyDoc = new Y.Doc({ gc: false })\r\n      Y.applyUpdateV2(historyDoc, prevSnapshot)\r\n      prevSnapshot = Y.snapshot(historyDoc)\r\n      Y.applyUpdateV2(historyDoc, snapshot)\r\n      snapshot = Y.snapshot(historyDoc)\r\n      if (historyType._item === null) {\r\n        /**\r\n         * If is a root type, we need to find the root key in the initial document\r\n         * and use it to get the history type.\r\n         */\r\n        const rootKey = Array.from(this.doc.share.keys()).find(\r\n          (key) => this.doc.share.get(key) === this.type\r\n        )\r\n        historyType = historyDoc.getXmlFragment(rootKey)\r\n      } else {\r\n        /**\r\n         * If it is a sub type, we use the item id to find the history type.\r\n         */\r\n        const historyStructs =\r\n          historyDoc.store.clients.get(historyType._item.id.client) ?? []\r\n        const itemIndex = Y.findIndexSS(\r\n          historyStructs,\r\n          historyType._item.id.clock\r\n        )\r\n        const item = /** @type {Y.Item} */ (historyStructs[itemIndex])\r\n        const content = /** @type {Y.ContentType} */ (item.content)\r\n        historyType = /** @type {Y.XmlFragment} */ (content.type)\r\n      }\r\n    }\r\n    // clear mapping because we are going to rerender\r\n    this.mapping.clear()\r\n    this.mux(() => {\r\n      historyDoc.transact((transaction) => {\r\n        // before rendering, we are going to sanitize ops and split deleted ops\r\n        // if they were deleted by seperate users.\r\n        /**\r\n         * @type {Y.PermanentUserData}\r\n         */\r\n        const pud = pluginState.permanentUserData\r\n        if (pud) {\r\n          pud.dss.forEach((ds) => {\r\n            Y.iterateDeletedStructs(transaction, ds, (_item) => {})\r\n          })\r\n        }\r\n        /**\r\n         * @param {'removed'|'added'} type\r\n         * @param {Y.ID} id\r\n         */\r\n        const computeYChange = (type, id) => {\r\n          const user = type === 'added'\r\n            ? pud.getUserByClientId(id.client)\r\n            : pud.getUserByDeletedId(id)\r\n          return {\r\n            user,\r\n            type,\r\n            color: getUserColor(\r\n              pluginState.colorMapping,\r\n              pluginState.colors,\r\n              user\r\n            )\r\n          }\r\n        }\r\n        // Create document fragment and render\r\n        const fragmentContent = Y.typeListToArraySnapshot(\r\n          historyType,\r\n          new Y.Snapshot(prevSnapshot.ds, snapshot.sv)\r\n        ).map((t) => {\r\n          if (\r\n            !t._item.deleted || isVisible(t._item, snapshot) ||\r\n            isVisible(t._item, prevSnapshot)\r\n          ) {\r\n            return createNodeFromYElement(\r\n              t,\r\n              this.prosemirrorView.state.schema,\r\n              { mapping: new Map(), isOMark: new Map() },\r\n              snapshot,\r\n              prevSnapshot,\r\n              computeYChange\r\n            )\r\n          } else {\r\n            // No need to render elements that are not visible by either snapshot.\r\n            // If a client adds and deletes content in the same snapshot the element is not visible by either snapshot.\r\n            return null\r\n          }\r\n        }).filter((n) => n !== null)\r\n        // @ts-ignore\r\n        const tr = this._tr.replace(\r\n          0,\r\n          this.prosemirrorView.state.doc.content.size,\r\n          new PModel.Slice(PModel.Fragment.from(fragmentContent), 0, 0)\r\n        )\r\n        this.prosemirrorView.dispatch(\r\n          tr.setMeta(ySyncPluginKey, { isChangeOrigin: true })\r\n        )\r\n      }, ySyncPluginKey)\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @param {Array<Y.YEvent<any>>} events\r\n   * @param {Y.Transaction} transaction\r\n   */\r\n  _typeChanged (events, transaction) {\r\n    if (this.prosemirrorView == null) return\r\n    const syncState = ySyncPluginKey.getState(this.prosemirrorView.state)\r\n    if (\r\n      events.length === 0 || syncState.snapshot != null ||\r\n      syncState.prevSnapshot != null\r\n    ) {\r\n      // drop out if snapshot is active\r\n      this.renderSnapshot(syncState.snapshot, syncState.prevSnapshot)\r\n      return\r\n    }\r\n    this.mux(() => {\r\n      /**\r\n       * @param {any} _\r\n       * @param {Y.AbstractType<any>} type\r\n       */\r\n      const delType = (_, type) => this.mapping.delete(type)\r\n      Y.iterateDeletedStructs(\r\n        transaction,\r\n        transaction.deleteSet,\r\n        (struct) => {\r\n          if (struct.constructor === Y.Item) {\r\n            const type = /** @type {Y.ContentType} */ (/** @type {Y.Item} */ (struct).content).type\r\n            type && this.mapping.delete(type)\r\n          }\r\n        }\r\n      )\r\n      transaction.changed.forEach(delType)\r\n      transaction.changedParentTypes.forEach(delType)\r\n      const fragmentContent = this.type.toArray().map((t) =>\r\n        createNodeIfNotExists(\r\n          /** @type {Y.XmlElement | Y.XmlHook} */ (t),\r\n          this.prosemirrorView.state.schema,\r\n          this\r\n        )\r\n      ).filter((n) => n !== null)\r\n      // @ts-ignore\r\n      let tr = this._tr.replace(\r\n        0,\r\n        this.prosemirrorView.state.doc.content.size,\r\n        new PModel.Slice(PModel.Fragment.from(fragmentContent), 0, 0)\r\n      )\r\n      restoreRelativeSelection(tr, this.beforeTransactionSelection, this)\r\n      tr = tr.setMeta(ySyncPluginKey, { isChangeOrigin: true, isUndoRedoOperation: transaction.origin instanceof Y.UndoManager })\r\n      if (\r\n        this.beforeTransactionSelection !== null && this._isLocalCursorInView()\r\n      ) {\r\n        tr.scrollIntoView()\r\n      }\r\n      this.prosemirrorView.dispatch(tr)\r\n    })\r\n  }\r\n\r\n  /**\r\n   * @param {import('prosemirror-model').Node} doc\r\n   */\r\n  _prosemirrorChanged (doc) {\r\n    this.doc.transact(() => {\r\n      updateYFragment(this.doc, this.type, doc, this)\r\n      this.beforeTransactionSelection = getRelativeSelection(\r\n        this,\r\n        this.prosemirrorView.state\r\n      )\r\n    }, ySyncPluginKey)\r\n  }\r\n\r\n  /**\r\n   * View is ready to listen to changes. Register observers.\r\n   * @param {any} prosemirrorView\r\n   */\r\n  initView (prosemirrorView) {\r\n    if (this.prosemirrorView != null) this.destroy()\r\n    this.prosemirrorView = prosemirrorView\r\n    this.doc.on('beforeAllTransactions', this.beforeAllTransactions)\r\n    this.doc.on('afterAllTransactions', this.afterAllTransactions)\r\n    this.type.observeDeep(this._observeFunction)\r\n  }\r\n\r\n  destroy () {\r\n    if (this.prosemirrorView == null) return\r\n    this.prosemirrorView = null\r\n    this.type.unobserveDeep(this._observeFunction)\r\n    this.doc.off('beforeAllTransactions', this.beforeAllTransactions)\r\n    this.doc.off('afterAllTransactions', this.afterAllTransactions)\r\n  }\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {Y.XmlElement | Y.XmlHook} el\r\n * @param {PModel.Schema} schema\r\n * @param {BindingMetadata} meta\r\n * @param {Y.Snapshot} [snapshot]\r\n * @param {Y.Snapshot} [prevSnapshot]\r\n * @param {function('removed' | 'added', Y.ID):any} [computeYChange]\r\n * @return {PModel.Node | null}\r\n */\r\nconst createNodeIfNotExists = (\r\n  el,\r\n  schema,\r\n  meta,\r\n  snapshot,\r\n  prevSnapshot,\r\n  computeYChange\r\n) => {\r\n  const node = /** @type {PModel.Node} */ (meta.mapping.get(el))\r\n  if (node === undefined) {\r\n    if (el instanceof Y.XmlElement) {\r\n      return createNodeFromYElement(\r\n        el,\r\n        schema,\r\n        meta,\r\n        snapshot,\r\n        prevSnapshot,\r\n        computeYChange\r\n      )\r\n    } else {\r\n      throw error.methodUnimplemented() // we are currently not handling hooks\r\n    }\r\n  }\r\n  return node\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {Y.XmlElement} el\r\n * @param {any} schema\r\n * @param {BindingMetadata} meta\r\n * @param {Y.Snapshot} [snapshot]\r\n * @param {Y.Snapshot} [prevSnapshot]\r\n * @param {function('removed' | 'added', Y.ID):any} [computeYChange]\r\n * @return {PModel.Node | null} Returns node if node could be created. Otherwise it deletes the yjs type and returns null\r\n */\r\nexport const createNodeFromYElement = (\r\n  el,\r\n  schema,\r\n  meta,\r\n  snapshot,\r\n  prevSnapshot,\r\n  computeYChange\r\n) => {\r\n  const children = []\r\n  /**\r\n   * @param {Y.XmlElement | Y.XmlText} type\r\n   */\r\n  const createChildren = (type) => {\r\n    if (type instanceof Y.XmlElement) {\r\n      const n = createNodeIfNotExists(\r\n        type,\r\n        schema,\r\n        meta,\r\n        snapshot,\r\n        prevSnapshot,\r\n        computeYChange\r\n      )\r\n      if (n !== null) {\r\n        children.push(n)\r\n      }\r\n    } else {\r\n      // If the next ytext exists and was created by us, move the content to the current ytext.\r\n      // This is a fix for #160 -- duplication of characters when two Y.Text exist next to each\r\n      // other.\r\n      const nextytext = /** @type {Y.ContentType} */ (type._item.right?.content)?.type\r\n      if (nextytext instanceof Y.Text && !nextytext._item.deleted && nextytext._item.id.client === nextytext.doc.clientID) {\r\n        type.applyDelta([\r\n          { retain: type.length },\r\n          ...nextytext.toDelta()\r\n        ])\r\n        nextytext.doc.transact(tr => {\r\n          nextytext._item.delete(tr)\r\n        })\r\n      }\r\n      // now create the prosemirror text nodes\r\n      const ns = createTextNodesFromYText(\r\n        type,\r\n        schema,\r\n        meta,\r\n        snapshot,\r\n        prevSnapshot,\r\n        computeYChange\r\n      )\r\n      if (ns !== null) {\r\n        ns.forEach((textchild) => {\r\n          if (textchild !== null) {\r\n            children.push(textchild)\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n  if (snapshot === undefined || prevSnapshot === undefined) {\r\n    el.toArray().forEach(createChildren)\r\n  } else {\r\n    Y.typeListToArraySnapshot(el, new Y.Snapshot(prevSnapshot.ds, snapshot.sv))\r\n      .forEach(createChildren)\r\n  }\r\n  try {\r\n    const attrs = el.getAttributes(snapshot)\r\n    if (snapshot !== undefined) {\r\n      if (!isVisible(/** @type {Y.Item} */ (el._item), snapshot)) {\r\n        attrs.ychange = computeYChange\r\n          ? computeYChange('removed', /** @type {Y.Item} */ (el._item).id)\r\n          : { type: 'removed' }\r\n      } else if (!isVisible(/** @type {Y.Item} */ (el._item), prevSnapshot)) {\r\n        attrs.ychange = computeYChange\r\n          ? computeYChange('added', /** @type {Y.Item} */ (el._item).id)\r\n          : { type: 'added' }\r\n      }\r\n    }\r\n    const node = schema.node(el.nodeName, attrs, children)\r\n    meta.mapping.set(el, node)\r\n    return node\r\n  } catch (e) {\r\n    // an error occured while creating the node. This is probably a result of a concurrent action.\r\n    /** @type {Y.Doc} */ (el.doc).transact((transaction) => {\r\n      /** @type {Y.Item} */ (el._item).delete(transaction)\r\n    }, ySyncPluginKey)\r\n    meta.mapping.delete(el)\r\n    return null\r\n  }\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {Y.XmlText} text\r\n * @param {import('prosemirror-model').Schema} schema\r\n * @param {BindingMetadata} _meta\r\n * @param {Y.Snapshot} [snapshot]\r\n * @param {Y.Snapshot} [prevSnapshot]\r\n * @param {function('removed' | 'added', Y.ID):any} [computeYChange]\r\n * @return {Array<PModel.Node>|null}\r\n */\r\nconst createTextNodesFromYText = (\r\n  text,\r\n  schema,\r\n  _meta,\r\n  snapshot,\r\n  prevSnapshot,\r\n  computeYChange\r\n) => {\r\n  const nodes = []\r\n  const deltas = text.toDelta(snapshot, prevSnapshot, computeYChange)\r\n  try {\r\n    for (let i = 0; i < deltas.length; i++) {\r\n      const delta = deltas[i]\r\n      nodes.push(schema.text(delta.insert, attributesToMarks(delta.attributes, schema)))\r\n    }\r\n  } catch (e) {\r\n    // an error occured while creating the node. This is probably a result of a concurrent action.\r\n    /** @type {Y.Doc} */ (text.doc).transact((transaction) => {\r\n      /** @type {Y.Item} */ (text._item).delete(transaction)\r\n    }, ySyncPluginKey)\r\n    return null\r\n  }\r\n  // @ts-ignore\r\n  return nodes\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {Array<any>} nodes prosemirror node\r\n * @param {BindingMetadata} meta\r\n * @return {Y.XmlText}\r\n */\r\nconst createTypeFromTextNodes = (nodes, meta) => {\r\n  const type = new Y.XmlText()\r\n  const delta = nodes.map((node) => ({\r\n    // @ts-ignore\r\n    insert: node.text,\r\n    attributes: marksToAttributes(node.marks, meta)\r\n  }))\r\n  type.applyDelta(delta)\r\n  meta.mapping.set(type, nodes)\r\n  return type\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {any} node prosemirror node\r\n * @param {BindingMetadata} meta\r\n * @return {Y.XmlElement}\r\n */\r\nconst createTypeFromElementNode = (node, meta) => {\r\n  const type = new Y.XmlElement(node.type.name)\r\n  for (const key in node.attrs) {\r\n    const val = node.attrs[key]\r\n    if (val !== null && key !== 'ychange') {\r\n      type.setAttribute(key, val)\r\n    }\r\n  }\r\n  type.insert(\r\n    0,\r\n    normalizePNodeContent(node).map((n) =>\r\n      createTypeFromTextOrElementNode(n, meta)\r\n    )\r\n  )\r\n  meta.mapping.set(type, node)\r\n  return type\r\n}\r\n\r\n/**\r\n * @private\r\n * @param {PModel.Node|Array<PModel.Node>} node prosemirror text node\r\n * @param {BindingMetadata} meta\r\n * @return {Y.XmlElement|Y.XmlText}\r\n */\r\nconst createTypeFromTextOrElementNode = (node, meta) =>\r\n  node instanceof Array\r\n    ? createTypeFromTextNodes(node, meta)\r\n    : createTypeFromElementNode(node, meta)\r\n\r\n/**\r\n * @param {any} val\r\n */\r\nconst isObject = (val) => typeof val === 'object' && val !== null\r\n\r\n/**\r\n * @param {any} pattrs\r\n * @param {any} yattrs\r\n */\r\nconst equalAttrs = (pattrs, yattrs) => {\r\n  const keys = Object.keys(pattrs).filter((key) => pattrs[key] !== null)\r\n  let eq =\r\n    keys.length ===\r\n      Object.keys(yattrs).filter((key) => yattrs[key] !== null).length\r\n  for (let i = 0; i < keys.length && eq; i++) {\r\n    const key = keys[i]\r\n    const l = pattrs[key]\r\n    const r = yattrs[key]\r\n    eq = key === 'ychange' || l === r ||\r\n      (isObject(l) && isObject(r) && equalAttrs(l, r))\r\n  }\r\n  return eq\r\n}\r\n\r\n/**\r\n * @typedef {Array<Array<PModel.Node>|PModel.Node>} NormalizedPNodeContent\r\n */\r\n\r\n/**\r\n * @param {any} pnode\r\n * @return {NormalizedPNodeContent}\r\n */\r\nconst normalizePNodeContent = (pnode) => {\r\n  const c = pnode.content.content\r\n  const res = []\r\n  for (let i = 0; i < c.length; i++) {\r\n    const n = c[i]\r\n    if (n.isText) {\r\n      const textNodes = []\r\n      for (let tnode = c[i]; i < c.length && tnode.isText; tnode = c[++i]) {\r\n        textNodes.push(tnode)\r\n      }\r\n      i--\r\n      res.push(textNodes)\r\n    } else {\r\n      res.push(n)\r\n    }\r\n  }\r\n  return res\r\n}\r\n\r\n/**\r\n * @param {Y.XmlText} ytext\r\n * @param {Array<any>} ptexts\r\n */\r\nconst equalYTextPText = (ytext, ptexts) => {\r\n  const delta = ytext.toDelta()\r\n  return delta.length === ptexts.length &&\r\n    delta.every(/** @type {(d:any,i:number) => boolean} */ (d, i) =>\r\n      d.insert === /** @type {any} */ (ptexts[i]).text &&\r\n      object.keys(d.attributes || {}).length === ptexts[i].marks.length &&\r\n      object.every(d.attributes, (attr, yattrname) => {\r\n        const markname = yattr2markname(yattrname)\r\n        const pmarks = ptexts[i].marks\r\n        return equalAttrs(attr, pmarks.find(/** @param {any} mark */ mark => mark.type.name === markname)?.attrs)\r\n      })\r\n    )\r\n}\r\n\r\n/**\r\n * @param {Y.XmlElement|Y.XmlText|Y.XmlHook} ytype\r\n * @param {any|Array<any>} pnode\r\n */\r\nconst equalYTypePNode = (ytype, pnode) => {\r\n  if (\r\n    ytype instanceof Y.XmlElement && !(pnode instanceof Array) &&\r\n    matchNodeName(ytype, pnode)\r\n  ) {\r\n    const normalizedContent = normalizePNodeContent(pnode)\r\n    return ytype._length === normalizedContent.length &&\r\n      equalAttrs(ytype.getAttributes(), pnode.attrs) &&\r\n      ytype.toArray().every((ychild, i) =>\r\n        equalYTypePNode(ychild, normalizedContent[i])\r\n      )\r\n  }\r\n  return ytype instanceof Y.XmlText && pnode instanceof Array &&\r\n    equalYTextPText(ytype, pnode)\r\n}\r\n\r\n/**\r\n * @param {PModel.Node | Array<PModel.Node> | undefined} mapped\r\n * @param {PModel.Node | Array<PModel.Node>} pcontent\r\n */\r\nconst mappedIdentity = (mapped, pcontent) =>\r\n  mapped === pcontent ||\r\n  (mapped instanceof Array && pcontent instanceof Array &&\r\n    mapped.length === pcontent.length && mapped.every((a, i) =>\r\n    pcontent[i] === a\r\n  ))\r\n\r\n/**\r\n * @param {Y.XmlElement} ytype\r\n * @param {PModel.Node} pnode\r\n * @param {BindingMetadata} meta\r\n * @return {{ foundMappedChild: boolean, equalityFactor: number }}\r\n */\r\nconst computeChildEqualityFactor = (ytype, pnode, meta) => {\r\n  const yChildren = ytype.toArray()\r\n  const pChildren = normalizePNodeContent(pnode)\r\n  const pChildCnt = pChildren.length\r\n  const yChildCnt = yChildren.length\r\n  const minCnt = math.min(yChildCnt, pChildCnt)\r\n  let left = 0\r\n  let right = 0\r\n  let foundMappedChild = false\r\n  for (; left < minCnt; left++) {\r\n    const leftY = yChildren[left]\r\n    const leftP = pChildren[left]\r\n    if (mappedIdentity(meta.mapping.get(leftY), leftP)) {\r\n      foundMappedChild = true // definite (good) match!\r\n    } else if (!equalYTypePNode(leftY, leftP)) {\r\n      break\r\n    }\r\n  }\r\n  for (; left + right < minCnt; right++) {\r\n    const rightY = yChildren[yChildCnt - right - 1]\r\n    const rightP = pChildren[pChildCnt - right - 1]\r\n    if (mappedIdentity(meta.mapping.get(rightY), rightP)) {\r\n      foundMappedChild = true\r\n    } else if (!equalYTypePNode(rightY, rightP)) {\r\n      break\r\n    }\r\n  }\r\n  return {\r\n    equalityFactor: left + right,\r\n    foundMappedChild\r\n  }\r\n}\r\n\r\n/**\r\n * @param {Y.Text} ytext\r\n */\r\nconst ytextTrans = (ytext) => {\r\n  let str = ''\r\n  /**\r\n   * @type {Y.Item|null}\r\n   */\r\n  let n = ytext._start\r\n  const nAttrs = {}\r\n  while (n !== null) {\r\n    if (!n.deleted) {\r\n      if (n.countable && n.content instanceof Y.ContentString) {\r\n        str += n.content.str\r\n      } else if (n.content instanceof Y.ContentFormat) {\r\n        nAttrs[n.content.key] = null\r\n      }\r\n    }\r\n    n = n.right\r\n  }\r\n  return {\r\n    str,\r\n    nAttrs\r\n  }\r\n}\r\n\r\n/**\r\n * @todo test this more\r\n *\r\n * @param {Y.Text} ytext\r\n * @param {Array<any>} ptexts\r\n * @param {BindingMetadata} meta\r\n */\r\nconst updateYText = (ytext, ptexts, meta) => {\r\n  meta.mapping.set(ytext, ptexts)\r\n  const { nAttrs, str } = ytextTrans(ytext)\r\n  const content = ptexts.map((p) => ({\r\n    insert: /** @type {any} */ (p).text,\r\n    attributes: Object.assign({}, nAttrs, marksToAttributes(p.marks, meta))\r\n  }))\r\n  const { insert, remove, index } = simpleDiff(\r\n    str,\r\n    content.map((c) => c.insert).join('')\r\n  )\r\n  ytext.delete(index, remove)\r\n  ytext.insert(index, insert)\r\n  ytext.applyDelta(\r\n    content.map((c) => ({ retain: c.insert.length, attributes: c.attributes }))\r\n  )\r\n}\r\n\r\nconst hashedMarkNameRegex = /(.*)(--[a-zA-Z0-9+/=]{8})$/\r\n/**\r\n * @param {string} attrName\r\n */\r\nexport const yattr2markname = attrName => hashedMarkNameRegex.exec(attrName)?.[1] ?? attrName\r\n\r\n/**\r\n * @todo move this to markstoattributes\r\n *\r\n * @param {Object<string, any>} attrs\r\n * @param {import('prosemirror-model').Schema} schema\r\n */\r\nexport const attributesToMarks = (attrs, schema) => {\r\n  /**\r\n   * @type {Array<import('prosemirror-model').Mark>}\r\n   */\r\n  const marks = []\r\n  for (const markName in attrs) {\r\n    // remove hashes if necessary\r\n    marks.push(schema.mark(yattr2markname(markName), attrs[markName]))\r\n  }\r\n  return marks\r\n}\r\n\r\n/**\r\n * @param {Array<import('prosemirror-model').Mark>} marks\r\n * @param {BindingMetadata} meta\r\n */\r\nconst marksToAttributes = (marks, meta) => {\r\n  const pattrs = {}\r\n  marks.forEach((mark) => {\r\n    if (mark.type.name !== 'ychange') {\r\n      const isOverlapping = map.setIfUndefined(meta.isOMark, mark.type, () => !mark.type.excludes(mark.type))\r\n      pattrs[isOverlapping ? `${mark.type.name}--${utils.hashOfJSON(mark.toJSON())}` : mark.type.name] = mark.attrs\r\n    }\r\n  })\r\n  return pattrs\r\n}\r\n\r\n/**\r\n * Update a yDom node by syncing the current content of the prosemirror node.\r\n *\r\n * This is a y-prosemirror internal feature that you can use at your own risk.\r\n *\r\n * @private\r\n * @unstable\r\n *\r\n * @param {{transact: Function}} y\r\n * @param {Y.XmlFragment} yDomFragment\r\n * @param {any} pNode\r\n * @param {BindingMetadata} meta\r\n */\r\nexport const updateYFragment = (y, yDomFragment, pNode, meta) => {\r\n  if (\r\n    yDomFragment instanceof Y.XmlElement &&\r\n    yDomFragment.nodeName !== pNode.type.name\r\n  ) {\r\n    throw new Error('node name mismatch!')\r\n  }\r\n  meta.mapping.set(yDomFragment, pNode)\r\n  // update attributes\r\n  if (yDomFragment instanceof Y.XmlElement) {\r\n    const yDomAttrs = yDomFragment.getAttributes()\r\n    const pAttrs = pNode.attrs\r\n    for (const key in pAttrs) {\r\n      if (pAttrs[key] !== null) {\r\n        if (yDomAttrs[key] !== pAttrs[key] && key !== 'ychange') {\r\n          yDomFragment.setAttribute(key, pAttrs[key])\r\n        }\r\n      } else {\r\n        yDomFragment.removeAttribute(key)\r\n      }\r\n    }\r\n    // remove all keys that are no longer in pAttrs\r\n    for (const key in yDomAttrs) {\r\n      if (pAttrs[key] === undefined) {\r\n        yDomFragment.removeAttribute(key)\r\n      }\r\n    }\r\n  }\r\n  // update children\r\n  const pChildren = normalizePNodeContent(pNode)\r\n  const pChildCnt = pChildren.length\r\n  const yChildren = yDomFragment.toArray()\r\n  const yChildCnt = yChildren.length\r\n  const minCnt = math.min(pChildCnt, yChildCnt)\r\n  let left = 0\r\n  let right = 0\r\n  // find number of matching elements from left\r\n  for (; left < minCnt; left++) {\r\n    const leftY = yChildren[left]\r\n    const leftP = pChildren[left]\r\n    if (!mappedIdentity(meta.mapping.get(leftY), leftP)) {\r\n      if (equalYTypePNode(leftY, leftP)) {\r\n        // update mapping\r\n        meta.mapping.set(leftY, leftP)\r\n      } else {\r\n        break\r\n      }\r\n    }\r\n  }\r\n  // find number of matching elements from right\r\n  for (; right + left + 1 < minCnt; right++) {\r\n    const rightY = yChildren[yChildCnt - right - 1]\r\n    const rightP = pChildren[pChildCnt - right - 1]\r\n    if (!mappedIdentity(meta.mapping.get(rightY), rightP)) {\r\n      if (equalYTypePNode(rightY, rightP)) {\r\n        // update mapping\r\n        meta.mapping.set(rightY, rightP)\r\n      } else {\r\n        break\r\n      }\r\n    }\r\n  }\r\n  y.transact(() => {\r\n    // try to compare and update\r\n    while (yChildCnt - left - right > 0 && pChildCnt - left - right > 0) {\r\n      const leftY = yChildren[left]\r\n      const leftP = pChildren[left]\r\n      const rightY = yChildren[yChildCnt - right - 1]\r\n      const rightP = pChildren[pChildCnt - right - 1]\r\n      if (leftY instanceof Y.XmlText && leftP instanceof Array) {\r\n        if (!equalYTextPText(leftY, leftP)) {\r\n          updateYText(leftY, leftP, meta)\r\n        }\r\n        left += 1\r\n      } else {\r\n        let updateLeft = leftY instanceof Y.XmlElement &&\r\n          matchNodeName(leftY, leftP)\r\n        let updateRight = rightY instanceof Y.XmlElement &&\r\n          matchNodeName(rightY, rightP)\r\n        if (updateLeft && updateRight) {\r\n          // decide which which element to update\r\n          const equalityLeft = computeChildEqualityFactor(\r\n            /** @type {Y.XmlElement} */ (leftY),\r\n            /** @type {PModel.Node} */ (leftP),\r\n            meta\r\n          )\r\n          const equalityRight = computeChildEqualityFactor(\r\n            /** @type {Y.XmlElement} */ (rightY),\r\n            /** @type {PModel.Node} */ (rightP),\r\n            meta\r\n          )\r\n          if (\r\n            equalityLeft.foundMappedChild && !equalityRight.foundMappedChild\r\n          ) {\r\n            updateRight = false\r\n          } else if (\r\n            !equalityLeft.foundMappedChild && equalityRight.foundMappedChild\r\n          ) {\r\n            updateLeft = false\r\n          } else if (\r\n            equalityLeft.equalityFactor < equalityRight.equalityFactor\r\n          ) {\r\n            updateLeft = false\r\n          } else {\r\n            updateRight = false\r\n          }\r\n        }\r\n        if (updateLeft) {\r\n          updateYFragment(\r\n            y,\r\n            /** @type {Y.XmlFragment} */ (leftY),\r\n            /** @type {PModel.Node} */ (leftP),\r\n            meta\r\n          )\r\n          left += 1\r\n        } else if (updateRight) {\r\n          updateYFragment(\r\n            y,\r\n            /** @type {Y.XmlFragment} */ (rightY),\r\n            /** @type {PModel.Node} */ (rightP),\r\n            meta\r\n          )\r\n          right += 1\r\n        } else {\r\n          meta.mapping.delete(yDomFragment.get(left))\r\n          yDomFragment.delete(left, 1)\r\n          yDomFragment.insert(left, [\r\n            createTypeFromTextOrElementNode(leftP, meta)\r\n          ])\r\n          left += 1\r\n        }\r\n      }\r\n    }\r\n    const yDelLen = yChildCnt - left - right\r\n    if (\r\n      yChildCnt === 1 && pChildCnt === 0 && yChildren[0] instanceof Y.XmlText\r\n    ) {\r\n      meta.mapping.delete(yChildren[0])\r\n      // Edge case handling https://github.com/yjs/y-prosemirror/issues/108\r\n      // Only delete the content of the Y.Text to retain remote changes on the same Y.Text object\r\n      yChildren[0].delete(0, yChildren[0].length)\r\n    } else if (yDelLen > 0) {\r\n      yDomFragment.slice(left, left + yDelLen).forEach(type => meta.mapping.delete(type))\r\n      yDomFragment.delete(left, yDelLen)\r\n    }\r\n    if (left + right < pChildCnt) {\r\n      const ins = []\r\n      for (let i = left; i < pChildCnt - right; i++) {\r\n        ins.push(createTypeFromTextOrElementNode(pChildren[i], meta))\r\n      }\r\n      yDomFragment.insert(left, ins)\r\n    }\r\n  }, ySyncPluginKey)\r\n}\r\n\r\n/**\r\n * @function\r\n * @param {Y.XmlElement} yElement\r\n * @param {any} pNode Prosemirror Node\r\n */\r\nconst matchNodeName = (yElement, pNode) =>\r\n  !(pNode instanceof Array) && yElement.nodeName === pNode.type.name\r\n","import { updateYFragment, createNodeFromYElement, yattr2markname, createEmptyMeta } from './plugins/sync-plugin.js' // eslint-disable-line\r\nimport { ySyncPluginKey } from './plugins/keys.js'\r\nimport * as Y from 'yjs'\r\nimport { EditorView } from 'prosemirror-view' // eslint-disable-line\r\nimport { Node, Schema, Fragment } from 'prosemirror-model' // eslint-disable-line\r\nimport * as error from 'lib0/error'\r\nimport * as map from 'lib0/map'\r\nimport * as eventloop from 'lib0/eventloop'\r\n\r\n/**\r\n * Either a node if type is YXmlElement or an Array of text nodes if YXmlText\r\n * @typedef {Map<Y.AbstractType, Node | Array<Node>>} ProsemirrorMapping\r\n */\r\n\r\n/**\r\n * Is null if no timeout is in progress.\r\n * Is defined if a timeout is in progress.\r\n * Maps from view\r\n * @type {Map<EditorView, Map<any, any>>|null}\r\n */\r\nlet viewsToUpdate = null\r\n\r\nconst updateMetas = () => {\r\n  const ups = /** @type {Map<EditorView, Map<any, any>>} */ (viewsToUpdate)\r\n  viewsToUpdate = null\r\n  ups.forEach((metas, view) => {\r\n    const tr = view.state.tr\r\n    const syncState = ySyncPluginKey.getState(view.state)\r\n    if (syncState && syncState.binding && !syncState.binding.isDestroyed) {\r\n      metas.forEach((val, key) => {\r\n        tr.setMeta(key, val)\r\n      })\r\n      view.dispatch(tr)\r\n    }\r\n  })\r\n}\r\n\r\nexport const setMeta = (view, key, value) => {\r\n  if (!viewsToUpdate) {\r\n    viewsToUpdate = new Map()\r\n    eventloop.timeout(0, updateMetas)\r\n  }\r\n  map.setIfUndefined(viewsToUpdate, view, map.create).set(key, value)\r\n}\r\n\r\n/**\r\n * Transforms a Prosemirror based absolute position to a Yjs Cursor (relative position in the Yjs model).\r\n *\r\n * @param {number} pos\r\n * @param {Y.XmlFragment} type\r\n * @param {ProsemirrorMapping} mapping\r\n * @return {any} relative position\r\n */\r\nexport const absolutePositionToRelativePosition = (pos, type, mapping) => {\r\n  if (pos === 0) {\r\n    return Y.createRelativePositionFromTypeIndex(type, 0, -1)\r\n  }\r\n  /**\r\n   * @type {any}\r\n   */\r\n  let n = type._first === null ? null : /** @type {Y.ContentType} */ (type._first.content).type\r\n  while (n !== null && type !== n) {\r\n    if (n instanceof Y.XmlText) {\r\n      if (n._length >= pos) {\r\n        return Y.createRelativePositionFromTypeIndex(n, pos, -1)\r\n      } else {\r\n        pos -= n._length\r\n      }\r\n      if (n._item !== null && n._item.next !== null) {\r\n        n = /** @type {Y.ContentType} */ (n._item.next.content).type\r\n      } else {\r\n        do {\r\n          n = n._item === null ? null : n._item.parent\r\n          pos--\r\n        } while (n !== type && n !== null && n._item !== null && n._item.next === null)\r\n        if (n !== null && n !== type) {\r\n          // @ts-gnore we know that n.next !== null because of above loop conditition\r\n          n = n._item === null ? null : /** @type {Y.ContentType} */ (/** @type Y.Item */ (n._item.next).content).type\r\n        }\r\n      }\r\n    } else {\r\n      const pNodeSize = /** @type {any} */ (mapping.get(n) || { nodeSize: 0 }).nodeSize\r\n      if (n._first !== null && pos < pNodeSize) {\r\n        n = /** @type {Y.ContentType} */ (n._first.content).type\r\n        pos--\r\n      } else {\r\n        if (pos === 1 && n._length === 0 && pNodeSize > 1) {\r\n          // edge case, should end in this paragraph\r\n          return new Y.RelativePosition(n._item === null ? null : n._item.id, n._item === null ? Y.findRootTypeKey(n) : null, null)\r\n        }\r\n        pos -= pNodeSize\r\n        if (n._item !== null && n._item.next !== null) {\r\n          n = /** @type {Y.ContentType} */ (n._item.next.content).type\r\n        } else {\r\n          if (pos === 0) {\r\n            // set to end of n.parent\r\n            n = n._item === null ? n : n._item.parent\r\n            return new Y.RelativePosition(n._item === null ? null : n._item.id, n._item === null ? Y.findRootTypeKey(n) : null, null)\r\n          }\r\n          do {\r\n            n = /** @type {Y.Item} */ (n._item).parent\r\n            pos--\r\n          } while (n !== type && /** @type {Y.Item} */ (n._item).next === null)\r\n          // if n is null at this point, we have an unexpected case\r\n          if (n !== type) {\r\n            // We know that n._item.next is defined because of above loop condition\r\n            n = /** @type {Y.ContentType} */ (/** @type {Y.Item} */ (/** @type {Y.Item} */ (n._item).next).content).type\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (n === null) {\r\n      throw error.unexpectedCase()\r\n    }\r\n    if (pos === 0 && n.constructor !== Y.XmlText && n !== type) { // TODO: set to <= 0\r\n      return createRelativePosition(n._item.parent, n._item)\r\n    }\r\n  }\r\n  return Y.createRelativePositionFromTypeIndex(type, type._length, -1)\r\n}\r\n\r\nconst createRelativePosition = (type, item) => {\r\n  let typeid = null\r\n  let tname = null\r\n  if (type._item === null) {\r\n    tname = Y.findRootTypeKey(type)\r\n  } else {\r\n    typeid = Y.createID(type._item.id.client, type._item.id.clock)\r\n  }\r\n  return new Y.RelativePosition(typeid, tname, item.id)\r\n}\r\n\r\n/**\r\n * @param {Y.Doc} y\r\n * @param {Y.XmlFragment} documentType Top level type that is bound to pView\r\n * @param {any} relPos Encoded Yjs based relative position\r\n * @param {ProsemirrorMapping} mapping\r\n * @return {null|number}\r\n */\r\nexport const relativePositionToAbsolutePosition = (y, documentType, relPos, mapping) => {\r\n  const decodedPos = Y.createAbsolutePositionFromRelativePosition(relPos, y)\r\n  if (decodedPos === null || (decodedPos.type !== documentType && !Y.isParentOf(documentType, decodedPos.type._item))) {\r\n    return null\r\n  }\r\n  let type = decodedPos.type\r\n  let pos = 0\r\n  if (type.constructor === Y.XmlText) {\r\n    pos = decodedPos.index\r\n  } else if (type._item === null || !type._item.deleted) {\r\n    let n = type._first\r\n    let i = 0\r\n    while (i < type._length && i < decodedPos.index && n !== null) {\r\n      if (!n.deleted) {\r\n        const t = /** @type {Y.ContentType} */ (n.content).type\r\n        i++\r\n        if (t instanceof Y.XmlText) {\r\n          pos += t._length\r\n        } else {\r\n          pos += /** @type {any} */ (mapping.get(t)).nodeSize\r\n        }\r\n      }\r\n      n = /** @type {Y.Item} */ (n.right)\r\n    }\r\n    pos += 1 // increase because we go out of n\r\n  }\r\n  while (type !== documentType && type._item !== null) {\r\n    // @ts-ignore\r\n    const parent = type._item.parent\r\n    // @ts-ignore\r\n    if (parent._item === null || !parent._item.deleted) {\r\n      pos += 1 // the start tag\r\n      let n = /** @type {Y.AbstractType} */ (parent)._first\r\n      // now iterate until we found type\r\n      while (n !== null) {\r\n        const contentType = /** @type {Y.ContentType} */ (n.content).type\r\n        if (contentType === type) {\r\n          break\r\n        }\r\n        if (!n.deleted) {\r\n          if (contentType instanceof Y.XmlText) {\r\n            pos += contentType._length\r\n          } else {\r\n            pos += /** @type {any} */ (mapping.get(contentType)).nodeSize\r\n          }\r\n        }\r\n        n = n.right\r\n      }\r\n    }\r\n    type = /** @type {Y.AbstractType} */ (parent)\r\n  }\r\n  return pos - 1 // we don't count the most outer tag, because it is a fragment\r\n}\r\n\r\n/**\r\n * Utility function for converting an Y.Fragment to a ProseMirror fragment.\r\n *\r\n * @param {Y.XmlFragment} yXmlFragment\r\n * @param {Schema} schema\r\n */\r\nexport const yXmlFragmentToProseMirrorFragment = (yXmlFragment, schema) => {\r\n  const fragmentContent = yXmlFragment.toArray().map((t) =>\r\n    createNodeFromYElement(\r\n      /** @type {Y.XmlElement} */ (t),\r\n      schema,\r\n      createEmptyMeta()\r\n    )\r\n  ).filter((n) => n !== null)\r\n  return Fragment.fromArray(fragmentContent)\r\n}\r\n\r\n/**\r\n * Utility function for converting an Y.Fragment to a ProseMirror node.\r\n *\r\n * @param {Y.XmlFragment} yXmlFragment\r\n * @param {Schema} schema\r\n */\r\nexport const yXmlFragmentToProseMirrorRootNode = (yXmlFragment, schema) =>\r\n  schema.topNodeType.create(null, yXmlFragmentToProseMirrorFragment(yXmlFragment, schema))\r\n\r\n/**\r\n * The initial ProseMirror content should be supplied by Yjs. This function transforms a Y.Fragment\r\n * to a ProseMirror Doc node and creates a mapping that is used by the sync plugin.\r\n *\r\n * @param {Y.XmlFragment} yXmlFragment\r\n * @param {Schema} schema\r\n *\r\n * @todo deprecate mapping property\r\n */\r\nexport const initProseMirrorDoc = (yXmlFragment, schema) => {\r\n  const meta = createEmptyMeta()\r\n  const fragmentContent = yXmlFragment.toArray().map((t) =>\r\n    createNodeFromYElement(\r\n      /** @type {Y.XmlElement} */ (t),\r\n      schema,\r\n      meta\r\n    )\r\n  ).filter((n) => n !== null)\r\n  const doc = schema.topNodeType.create(null, Fragment.fromArray(fragmentContent))\r\n  return { doc, meta, mapping: meta.mapping }\r\n}\r\n\r\n/**\r\n * Utility method to convert a Prosemirror Doc Node into a Y.Doc.\r\n *\r\n * This can be used when importing existing content to Y.Doc for the first time,\r\n * note that this should not be used to rehydrate a Y.Doc from a database once\r\n * collaboration has begun as all history will be lost\r\n *\r\n * @param {Node} doc\r\n * @param {string} xmlFragment\r\n * @return {Y.Doc}\r\n */\r\nexport function prosemirrorToYDoc (doc, xmlFragment = 'prosemirror') {\r\n  const ydoc = new Y.Doc()\r\n  const type = /** @type {Y.XmlFragment} */ (ydoc.get(xmlFragment, Y.XmlFragment))\r\n  if (!type.doc) {\r\n    return ydoc\r\n  }\r\n\r\n  prosemirrorToYXmlFragment(doc, type)\r\n  return type.doc\r\n}\r\n\r\n/**\r\n * Utility method to update an empty Y.XmlFragment with content from a Prosemirror Doc Node.\r\n *\r\n * This can be used when importing existing content to Y.Doc for the first time,\r\n * note that this should not be used to rehydrate a Y.Doc from a database once\r\n * collaboration has begun as all history will be lost\r\n *\r\n * Note: The Y.XmlFragment does not need to be part of a Y.Doc document at the time that this\r\n * method is called, but it must be added before any other operations are performed on it.\r\n *\r\n * @param {Node} doc prosemirror document.\r\n * @param {Y.XmlFragment} [xmlFragment] If supplied, an xml fragment to be\r\n *   populated from the prosemirror state; otherwise a new XmlFragment will be created.\r\n * @return {Y.XmlFragment}\r\n */\r\nexport function prosemirrorToYXmlFragment (doc, xmlFragment) {\r\n  const type = xmlFragment || new Y.XmlFragment()\r\n  const ydoc = type.doc ? type.doc : { transact: (transaction) => transaction(undefined) }\r\n  updateYFragment(ydoc, type, doc, { mapping: new Map(), isOMark: new Map() })\r\n  return type\r\n}\r\n\r\n/**\r\n * Utility method to convert Prosemirror compatible JSON into a Y.Doc.\r\n *\r\n * This can be used when importing existing content to Y.Doc for the first time,\r\n * note that this should not be used to rehydrate a Y.Doc from a database once\r\n * collaboration has begun as all history will be lost\r\n *\r\n * @param {Schema} schema\r\n * @param {any} state\r\n * @param {string} xmlFragment\r\n * @return {Y.Doc}\r\n */\r\nexport function prosemirrorJSONToYDoc (schema, state, xmlFragment = 'prosemirror') {\r\n  const doc = Node.fromJSON(schema, state)\r\n  return prosemirrorToYDoc(doc, xmlFragment)\r\n}\r\n\r\n/**\r\n * Utility method to convert Prosemirror compatible JSON to a Y.XmlFragment\r\n *\r\n * This can be used when importing existing content to Y.Doc for the first time,\r\n * note that this should not be used to rehydrate a Y.Doc from a database once\r\n * collaboration has begun as all history will be lost\r\n *\r\n * @param {Schema} schema\r\n * @param {any} state\r\n * @param {Y.XmlFragment} [xmlFragment] If supplied, an xml fragment to be\r\n *   populated from the prosemirror state; otherwise a new XmlFragment will be created.\r\n * @return {Y.XmlFragment}\r\n */\r\nexport function prosemirrorJSONToYXmlFragment (schema, state, xmlFragment) {\r\n  const doc = Node.fromJSON(schema, state)\r\n  return prosemirrorToYXmlFragment(doc, xmlFragment)\r\n}\r\n\r\n/**\r\n * @deprecated Use `yXmlFragmentToProseMirrorRootNode` instead\r\n *\r\n * Utility method to convert a Y.Doc to a Prosemirror Doc node.\r\n *\r\n * @param {Schema} schema\r\n * @param {Y.Doc} ydoc\r\n * @return {Node}\r\n */\r\nexport function yDocToProsemirror (schema, ydoc) {\r\n  const state = yDocToProsemirrorJSON(ydoc)\r\n  return Node.fromJSON(schema, state)\r\n}\r\n\r\n/**\r\n *\r\n * @deprecated Use `yXmlFragmentToProseMirrorRootNode` instead\r\n *\r\n * Utility method to convert a Y.XmlFragment to a Prosemirror Doc node.\r\n *\r\n * @param {Schema} schema\r\n * @param {Y.XmlFragment} xmlFragment\r\n * @return {Node}\r\n */\r\nexport function yXmlFragmentToProsemirror (schema, xmlFragment) {\r\n  const state = yXmlFragmentToProsemirrorJSON(xmlFragment)\r\n  return Node.fromJSON(schema, state)\r\n}\r\n\r\n/**\r\n *\r\n * @deprecated Use `yXmlFragmentToProseMirrorRootNode` instead\r\n *\r\n * Utility method to convert a Y.Doc to Prosemirror compatible JSON.\r\n *\r\n * @param {Y.Doc} ydoc\r\n * @param {string} xmlFragment\r\n * @return {Record<string, any>}\r\n */\r\nexport function yDocToProsemirrorJSON (\r\n  ydoc,\r\n  xmlFragment = 'prosemirror'\r\n) {\r\n  return yXmlFragmentToProsemirrorJSON(ydoc.getXmlFragment(xmlFragment))\r\n}\r\n\r\n/**\r\n * @deprecated Use `yXmlFragmentToProseMirrorRootNode` instead\r\n *\r\n * Utility method to convert a Y.Doc to Prosemirror compatible JSON.\r\n *\r\n * @param {Y.XmlFragment} xmlFragment The fragment, which must be part of a Y.Doc.\r\n * @return {Record<string, any>}\r\n */\r\nexport function yXmlFragmentToProsemirrorJSON (xmlFragment) {\r\n  const items = xmlFragment.toArray()\r\n\r\n  /**\r\n   * @param {Y.AbstractType} item\r\n   */\r\n  const serialize = item => {\r\n    /**\r\n     * @type {Object} NodeObject\r\n     * @property {string} NodeObject.type\r\n     * @property {Record<string, string>=} NodeObject.attrs\r\n     * @property {Array<NodeObject>=} NodeObject.content\r\n     */\r\n    let response\r\n\r\n    // TODO: Must be a better way to detect text nodes than this\r\n    if (item instanceof Y.XmlText) {\r\n      const delta = item.toDelta()\r\n      response = delta.map(/** @param {any} d */ (d) => {\r\n        const text = {\r\n          type: 'text',\r\n          text: d.insert\r\n        }\r\n        if (d.attributes) {\r\n          text.marks = Object.keys(d.attributes).map((type_) => {\r\n            const attrs = d.attributes[type_]\r\n            const type = yattr2markname(type_)\r\n            const mark = {\r\n              type\r\n            }\r\n            if (Object.keys(attrs)) {\r\n              mark.attrs = attrs\r\n            }\r\n            return mark\r\n          })\r\n        }\r\n        return text\r\n      })\r\n    } else if (item instanceof Y.XmlElement) {\r\n      response = {\r\n        type: item.nodeName\r\n      }\r\n\r\n      const attrs = item.getAttributes()\r\n      if (Object.keys(attrs).length) {\r\n        response.attrs = attrs\r\n      }\r\n\r\n      const children = item.toArray()\r\n      if (children.length) {\r\n        response.content = children.map(serialize).flat()\r\n      }\r\n    } else {\r\n      // expected either Y.XmlElement or Y.XmlText\r\n      error.unexpectedCase()\r\n    }\r\n\r\n    return response\r\n  }\r\n\r\n  return {\r\n    type: 'doc',\r\n    content: items.map(serialize)\r\n  }\r\n}\r\n","import * as Y from 'yjs'\r\nimport { Decoration, DecorationSet } from \"prosemirror-view\"; // eslint-disable-line\r\nimport { Plugin } from \"prosemirror-state\"; // eslint-disable-line\r\nimport { Awareness } from \"y-protocols/awareness\"; // eslint-disable-line\r\nimport {\r\n  absolutePositionToRelativePosition,\r\n  relativePositionToAbsolutePosition,\r\n  setMeta\r\n} from '../lib.js'\r\nimport { yCursorPluginKey, ySyncPluginKey } from './keys.js'\r\n\r\nimport * as math from 'lib0/math'\r\n\r\n/**\r\n * Default awareness state filter\r\n *\r\n * @param {number} currentClientId current client id\r\n * @param {number} userClientId user client id\r\n * @param {any} _user user data\r\n * @return {boolean}\r\n */\r\nexport const defaultAwarenessStateFilter = (currentClientId, userClientId, _user) => currentClientId !== userClientId\r\n\r\n/**\r\n * Default generator for a cursor element\r\n *\r\n * @param {any} user user data\r\n * @return {HTMLElement}\r\n */\r\nexport const defaultCursorBuilder = (user) => {\r\n  const cursor = document.createElement('span')\r\n  cursor.classList.add('ProseMirror-yjs-cursor')\r\n  cursor.setAttribute('style', `border-color: ${user.color}`)\r\n  const userDiv = document.createElement('div')\r\n  userDiv.setAttribute('style', `background-color: ${user.color}`)\r\n  userDiv.insertBefore(document.createTextNode(user.name), null)\r\n  const nonbreakingSpace1 = document.createTextNode('\\u2060')\r\n  const nonbreakingSpace2 = document.createTextNode('\\u2060')\r\n  cursor.insertBefore(nonbreakingSpace1, null)\r\n  cursor.insertBefore(userDiv, null)\r\n  cursor.insertBefore(nonbreakingSpace2, null)\r\n  return cursor\r\n}\r\n\r\n/**\r\n * Default generator for the selection attributes\r\n *\r\n * @param {any} user user data\r\n * @return {import('prosemirror-view').DecorationAttrs}\r\n */\r\nexport const defaultSelectionBuilder = (user) => {\r\n  return {\r\n    style: `background-color: ${user.color}70`,\r\n    class: 'ProseMirror-yjs-selection'\r\n  }\r\n}\r\n\r\nconst rxValidColor = /^#[0-9a-fA-F]{6}$/\r\n\r\n/**\r\n * @param {any} state\r\n * @param {Awareness} awareness\r\n * @param {function(number, number, any):boolean} awarenessFilter\r\n * @param {(user: { name: string, color: string }, clientId: number) => Element} createCursor\r\n * @param {(user: { name: string, color: string }, clientId: number) => import('prosemirror-view').DecorationAttrs} createSelection\r\n * @return {any} DecorationSet\r\n */\r\nexport const createDecorations = (\r\n  state,\r\n  awareness,\r\n  awarenessFilter,\r\n  createCursor,\r\n  createSelection\r\n) => {\r\n  const ystate = ySyncPluginKey.getState(state)\r\n  const y = ystate.doc\r\n  const decorations = []\r\n  if (\r\n    ystate.snapshot != null || ystate.prevSnapshot != null ||\r\n    ystate.binding.mapping.size === 0\r\n  ) {\r\n    // do not render cursors while snapshot is active\r\n    return DecorationSet.create(state.doc, [])\r\n  }\r\n  awareness.getStates().forEach((aw, clientId) => {\r\n    if (!awarenessFilter(y.clientID, clientId, aw)) {\r\n      return\r\n    }\r\n\r\n    if (aw.cursor != null) {\r\n      const user = aw.user || {}\r\n      if (user.color == null) {\r\n        user.color = '#ffa500'\r\n      } else if (!rxValidColor.test(user.color)) {\r\n        // We only support 6-digit RGB colors in y-prosemirror\r\n        console.warn('A user uses an unsupported color format', user)\r\n      }\r\n      if (user.name == null) {\r\n        user.name = `User: ${clientId}`\r\n      }\r\n      let anchor = relativePositionToAbsolutePosition(\r\n        y,\r\n        ystate.type,\r\n        Y.createRelativePositionFromJSON(aw.cursor.anchor),\r\n        ystate.binding.mapping\r\n      )\r\n      let head = relativePositionToAbsolutePosition(\r\n        y,\r\n        ystate.type,\r\n        Y.createRelativePositionFromJSON(aw.cursor.head),\r\n        ystate.binding.mapping\r\n      )\r\n      if (anchor !== null && head !== null) {\r\n        const maxsize = math.max(state.doc.content.size - 1, 0)\r\n        anchor = math.min(anchor, maxsize)\r\n        head = math.min(head, maxsize)\r\n        decorations.push(\r\n          Decoration.widget(head, () => createCursor(user, clientId), {\r\n            key: clientId + '',\r\n            side: 10\r\n          })\r\n        )\r\n        const from = math.min(anchor, head)\r\n        const to = math.max(anchor, head)\r\n        decorations.push(\r\n          Decoration.inline(from, to, createSelection(user, clientId), {\r\n            inclusiveEnd: true,\r\n            inclusiveStart: false\r\n          })\r\n        )\r\n      }\r\n    }\r\n  })\r\n  return DecorationSet.create(state.doc, decorations)\r\n}\r\n\r\n/**\r\n * A prosemirror plugin that listens to awareness information on Yjs.\r\n * This requires that a `prosemirrorPlugin` is also bound to the prosemirror.\r\n *\r\n * @public\r\n * @param {Awareness} awareness\r\n * @param {object} opts\r\n * @param {function(any, any, any):boolean} [opts.awarenessStateFilter]\r\n * @param {(user: any, clientId: number) => HTMLElement} [opts.cursorBuilder]\r\n * @param {(user: any, clientId: number) => import('prosemirror-view').DecorationAttrs} [opts.selectionBuilder]\r\n * @param {function(any):any} [opts.getSelection]\r\n * @param {string} [cursorStateField] By default all editor bindings use the awareness 'cursor' field to propagate cursor information.\r\n * @return {any}\r\n */\r\nexport const yCursorPlugin = (\r\n  awareness,\r\n  {\r\n    awarenessStateFilter = defaultAwarenessStateFilter,\r\n    cursorBuilder = defaultCursorBuilder,\r\n    selectionBuilder = defaultSelectionBuilder,\r\n    getSelection = (state) => state.selection\r\n  } = {},\r\n  cursorStateField = 'cursor'\r\n) =>\r\n  new Plugin({\r\n    key: yCursorPluginKey,\r\n    state: {\r\n      init (_, state) {\r\n        return createDecorations(\r\n          state,\r\n          awareness,\r\n          awarenessStateFilter,\r\n          cursorBuilder,\r\n          selectionBuilder\r\n        )\r\n      },\r\n      apply (tr, prevState, _oldState, newState) {\r\n        const ystate = ySyncPluginKey.getState(newState)\r\n        const yCursorState = tr.getMeta(yCursorPluginKey)\r\n        if (\r\n          (ystate && ystate.isChangeOrigin) ||\r\n          (yCursorState && yCursorState.awarenessUpdated)\r\n        ) {\r\n          return createDecorations(\r\n            newState,\r\n            awareness,\r\n            awarenessStateFilter,\r\n            cursorBuilder,\r\n            selectionBuilder\r\n          )\r\n        }\r\n        return prevState.map(tr.mapping, tr.doc)\r\n      }\r\n    },\r\n    props: {\r\n      decorations: (state) => {\r\n        return yCursorPluginKey.getState(state)\r\n      }\r\n    },\r\n    view: (view) => {\r\n      const awarenessListener = () => {\r\n        // @ts-ignore\r\n        if (view.docView) {\r\n          setMeta(view, yCursorPluginKey, { awarenessUpdated: true })\r\n        }\r\n      }\r\n      const updateCursorInfo = () => {\r\n        const ystate = ySyncPluginKey.getState(view.state)\r\n        // @note We make implicit checks when checking for the cursor property\r\n        const current = awareness.getLocalState() || {}\r\n        if (view.hasFocus()) {\r\n          const selection = getSelection(view.state)\r\n          /**\r\n           * @type {Y.RelativePosition}\r\n           */\r\n          const anchor = absolutePositionToRelativePosition(\r\n            selection.anchor,\r\n            ystate.type,\r\n            ystate.binding.mapping\r\n          )\r\n          /**\r\n           * @type {Y.RelativePosition}\r\n           */\r\n          const head = absolutePositionToRelativePosition(\r\n            selection.head,\r\n            ystate.type,\r\n            ystate.binding.mapping\r\n          )\r\n          if (\r\n            current.cursor == null ||\r\n            !Y.compareRelativePositions(\r\n              Y.createRelativePositionFromJSON(current.cursor.anchor),\r\n              anchor\r\n            ) ||\r\n            !Y.compareRelativePositions(\r\n              Y.createRelativePositionFromJSON(current.cursor.head),\r\n              head\r\n            )\r\n          ) {\r\n            awareness.setLocalStateField(cursorStateField, {\r\n              anchor,\r\n              head\r\n            })\r\n          }\r\n        } else if (\r\n          current.cursor != null &&\r\n          relativePositionToAbsolutePosition(\r\n            ystate.doc,\r\n            ystate.type,\r\n            Y.createRelativePositionFromJSON(current.cursor.anchor),\r\n            ystate.binding.mapping\r\n          ) !== null\r\n        ) {\r\n          // delete cursor information if current cursor information is owned by this editor binding\r\n          awareness.setLocalStateField(cursorStateField, null)\r\n        }\r\n      }\r\n      awareness.on('change', awarenessListener)\r\n      view.dom.addEventListener('focusin', updateCursorInfo)\r\n      view.dom.addEventListener('focusout', updateCursorInfo)\r\n      return {\r\n        update: updateCursorInfo,\r\n        destroy: () => {\r\n          view.dom.removeEventListener('focusin', updateCursorInfo)\r\n          view.dom.removeEventListener('focusout', updateCursorInfo)\r\n          awareness.off('change', awarenessListener)\r\n          awareness.setLocalStateField(cursorStateField, null)\r\n        }\r\n      }\r\n    }\r\n  })\r\n","import { Plugin } from 'prosemirror-state' // eslint-disable-line\r\n\r\nimport { getRelativeSelection } from './sync-plugin.js'\r\nimport { UndoManager, Item, ContentType, XmlElement, Text } from 'yjs'\r\nimport { yUndoPluginKey, ySyncPluginKey } from './keys.js'\r\n\r\nexport const undo = state => {\r\n  const undoManager = yUndoPluginKey.getState(state).undoManager\r\n  if (undoManager != null) {\r\n    undoManager.undo()\r\n    return true\r\n  }\r\n}\r\n\r\nexport const redo = state => {\r\n  const undoManager = yUndoPluginKey.getState(state).undoManager\r\n  if (undoManager != null) {\r\n    undoManager.redo()\r\n    return true\r\n  }\r\n}\r\n\r\nexport const defaultProtectedNodes = new Set(['paragraph'])\r\n\r\nexport const defaultDeleteFilter = (item, protectedNodes) => !(item instanceof Item) ||\r\n!(item.content instanceof ContentType) ||\r\n!(item.content.type instanceof Text ||\r\n  (item.content.type instanceof XmlElement && protectedNodes.has(item.content.type.nodeName))) ||\r\nitem.content.type._length === 0\r\n\r\nexport const yUndoPlugin = ({ protectedNodes = defaultProtectedNodes, trackedOrigins = [], undoManager = null } = {}) => new Plugin({\r\n  key: yUndoPluginKey,\r\n  state: {\r\n    init: (initargs, state) => {\r\n      // TODO: check if plugin order matches and fix\r\n      const ystate = ySyncPluginKey.getState(state)\r\n      const _undoManager = undoManager || new UndoManager(ystate.type, {\r\n        trackedOrigins: new Set([ySyncPluginKey].concat(trackedOrigins)),\r\n        deleteFilter: (item) => defaultDeleteFilter(item, protectedNodes),\r\n        captureTransaction: tr => tr.meta.get('addToHistory') !== false\r\n      })\r\n      return {\r\n        undoManager: _undoManager,\r\n        prevSel: null,\r\n        hasUndoOps: _undoManager.undoStack.length > 0,\r\n        hasRedoOps: _undoManager.redoStack.length > 0\r\n      }\r\n    },\r\n    /**\r\n     * @returns {any}\r\n     */\r\n    apply: (tr, val, oldState, state) => {\r\n      const binding = ySyncPluginKey.getState(state).binding\r\n      const undoManager = val.undoManager\r\n      const hasUndoOps = undoManager.undoStack.length > 0\r\n      const hasRedoOps = undoManager.redoStack.length > 0\r\n      if (binding) {\r\n        return {\r\n          undoManager,\r\n          prevSel: getRelativeSelection(binding, oldState),\r\n          hasUndoOps,\r\n          hasRedoOps\r\n        }\r\n      } else {\r\n        if (hasUndoOps !== val.hasUndoOps || hasRedoOps !== val.hasRedoOps) {\r\n          return Object.assign({}, val, {\r\n            hasUndoOps: undoManager.undoStack.length > 0,\r\n            hasRedoOps: undoManager.redoStack.length > 0\r\n          })\r\n        } else { // nothing changed\r\n          return val\r\n        }\r\n      }\r\n    }\r\n  },\r\n  view: view => {\r\n    const ystate = ySyncPluginKey.getState(view.state)\r\n    const undoManager = yUndoPluginKey.getState(view.state).undoManager\r\n    undoManager.on('stack-item-added', ({ stackItem }) => {\r\n      const binding = ystate.binding\r\n      if (binding) {\r\n        stackItem.meta.set(binding, yUndoPluginKey.getState(view.state).prevSel)\r\n      }\r\n    })\r\n    undoManager.on('stack-item-popped', ({ stackItem }) => {\r\n      const binding = ystate.binding\r\n      if (binding) {\r\n        binding.beforeTransactionSelection = stackItem.meta.get(binding) || binding.beforeTransactionSelection\r\n      }\r\n    })\r\n    return {\r\n      destroy: () => {\r\n        undoManager.destroy()\r\n      }\r\n    }\r\n  }\r\n})\r\n"],"names":["utils.hashOfJSON"],"mappings":"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"}